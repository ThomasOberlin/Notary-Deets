<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IOTA Notarization — Immutable vs Versioned Documents (VeriPura Context)</title>
  <style>
    :root{
      --bg:#0b1220; --card:#0f1a30; --text:#e8eefc; --muted:#a9b6d3; --line:#22325a;
      --accent:#22c55e; --accent2:#60a5fa; --warn:#f59e0b; --bad:#ef4444;
      --shadow: 0 18px 50px rgba(0,0,0,.35); --radius: 18px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,Helvetica,Arial;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:var(--sans); color:var(--text);
      background: radial-gradient(1200px 600px at 20% 0%, rgba(96,165,250,.18), transparent 60%),
                  radial-gradient(1000px 500px at 80% 10%, rgba(34,197,94,.16), transparent 55%),
                  linear-gradient(180deg, #070c16, var(--bg));
    }
    .wrap{max-width:1100px; margin:0 auto; padding:28px 18px 64px;}
    header{
      display:flex; gap:14px; align-items:flex-start; justify-content:space-between; flex-wrap:wrap;
      margin-bottom:18px;
    }
    .title{
      flex:1 1 680px;
      padding:18px 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    h1{margin:0 0 6px; font-size:22px; letter-spacing:.2px;}
    .subtitle{margin:0; color:var(--muted); line-height:1.45; font-size:14px;}
    .pillrow{display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:12px;}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,16,30,.55);
      padding:8px 10px;
      border-radius:999px;
      color:var(--muted);
      font-size:12px;
    }
    .dot{width:8px; height:8px; border-radius:50%;}
    .dot.green{background:var(--accent)}
    .dot.blue{background:var(--accent2)}
    .dot.amber{background:var(--warn)}
    nav{
      flex:0 0 auto;
      display:flex; gap:10px; flex-wrap:wrap;
      align-items:center; justify-content:flex-end;
    }
    nav a{
      color:var(--text); text-decoration:none; font-size:13px;
      padding:10px 12px; border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,16,30,.45);
    }
    nav a:hover{border-color: rgba(96,165,250,.6)}
    .grid{display:grid; grid-template-columns: 1fr; gap:14px; margin-top:14px;}
    @media (min-width: 980px){
      .grid{grid-template-columns: 1.2fr .8fr;}
    }
    section.card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:18px;
    }
    h2{margin:0 0 10px; font-size:16px;}
    h3{margin:14px 0 8px; font-size:14px; color:#dbe7ff;}
    p{margin:10px 0; color:var(--muted); line-height:1.6; font-size:14px;}
    ul{margin:8px 0 0 18px; color:var(--muted); line-height:1.6; font-size:14px;}
    li{margin:6px 0}
    .callout{
      border:1px solid rgba(34,197,94,.25);
      background: rgba(34,197,94,.08);
      padding:12px 12px;
      border-radius:14px;
      margin-top:12px;
    }
    .callout strong{color:#eafff1}
    .split{
      display:grid; grid-template-columns: 1fr; gap:12px; margin-top:12px;
    }
    @media (min-width: 780px){
      .split{grid-template-columns: 1fr 1fr;}
    }
    .mini{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,16,30,.35);
      border-radius:14px;
      padding:12px;
    }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      font-size:12px; color:var(--muted);
      border:1px solid rgba(255,255,255,.12);
      background: rgba(10,16,30,.35);
      padding:6px 10px; border-radius:999px;
    }
    code, pre{font-family:var(--mono);}
    pre{
      margin:10px 0 0;
      padding:12px;
      border-radius:14px;
      background: rgba(0,0,0,.28);
      border:1px solid rgba(255,255,255,.08);
      overflow:auto;
      color:#d7e4ff;
      font-size:12px;
      line-height:1.45;
    }
    .timeline{
      border-left:2px solid rgba(96,165,250,.35);
      margin:10px 0 0 4px;
      padding-left:14px;
    }
    .titem{
      margin:10px 0;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,16,30,.35);
      position:relative;
    }
    .titem::before{
      content:"";
      width:10px; height:10px;
      border-radius:50%;
      background: rgba(96,165,250,.9);
      position:absolute;
      left:-20px; top:14px;
      box-shadow: 0 0 0 4px rgba(96,165,250,.12);
    }
    .tmeta{font-size:12px; color:var(--muted); margin-top:6px;}
    .twoCol{
      display:grid; grid-template-columns:1fr; gap:12px;
    }
    @media (min-width: 980px){
      .twoCol{grid-template-columns:1fr 1fr;}
    }

    /* Quiz */
    .quizHead{
      display:flex; align-items:flex-start; justify-content:space-between; gap:12px; flex-wrap:wrap;
    }
    .quizMeta{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
    }
    .btn{
      cursor:pointer;
      border:none;
      padding:10px 12px;
      border-radius:12px;
      font-size:13px;
      color:#081224;
      background: linear-gradient(180deg, rgba(34,197,94,1), rgba(34,197,94,.85));
    }
    .btn.secondary{
      color: var(--text);
      background: rgba(10,16,30,.55);
      border:1px solid rgba(255,255,255,.10);
    }
    .btn:disabled{opacity:.6; cursor:not-allowed;}
    .q{
      margin-top:12px;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,16,30,.35);
    }
    .qtitle{margin:0 0 10px; font-size:14px;}
    .opts{display:grid; gap:8px;}
    label.opt{
      display:flex; gap:10px; align-items:flex-start;
      padding:10px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      color:var(--muted);
      cursor:pointer;
    }
    label.opt:hover{border-color: rgba(96,165,250,.5)}
    input[type="radio"]{margin-top:3px}
    .result{
      margin-top:12px;
      padding:12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.20);
      color:var(--muted);
      line-height:1.6;
      font-size:14px;
    }
    .score{
      font-size:14px; color:#eafff1;
    }
    .ok{color: #b9f6c9;}
    .bad{color: #ffb4b4;}
    footer{
      margin-top:14px;
      color:var(--muted);
      font-size:12px;
      opacity:.9;
      text-align:center;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <h1>IOTA Notarization for Compliance Documents</h1>
        <p class="subtitle">
          Practical summary of <strong>immutable notarization</strong> and <strong>versioned (change-tracked)</strong> documents,
          with concrete VeriPura-style food import compliance use cases and a short multiple-choice quiz.
        </p>
        <div class="pillrow">
          <span class="pill"><span class="dot green"></span> Immutable proof of existence</span>
          <span class="pill"><span class="dot blue"></span> Version chain with tracked changes</span>
          <span class="pill"><span class="dot amber"></span> Rebased-ready (smart contracts + identity)</span>
        </div>
      </div>
      <nav>
        <a href="#basics">Basics</a>
        <a href="#approaches">Two Approaches</a>
        <a href="#usecases">Use Cases</a>
        <a href="#implementation">Implementation Options</a>
        <a href="#quiz">Quiz</a>
      </nav>
    </header>

    <div class="grid">
      <section id="basics" class="card">
        <h2>What notarization does</h2>
        <p>
          Notarization anchors a cryptographic fingerprint (<strong>hash</strong>) of a document or dataset to the network.
          This produces tamper-evident, timestamped proof that “this exact content existed at time T” without revealing the content itself.
        </p>
        <div class="split">
          <div class="mini">
            <span class="badge">Core outcome</span>
            <ul>
              <li>Proof-of-existence at a specific timestamp</li>
              <li>Integrity check (detects changes)</li>
              <li>Portable verification (anyone can verify with the hash)</li>
            </ul>
          </div>
          <div class="mini">
            <span class="badge">Why this matters in trade</span>
            <ul>
              <li>Reduces “faxed copy of a photocopy” authenticity ambiguity</li>
              <li>Creates auditability across exporters, labs, forwarders, customs</li>
              <li>Turns disputes into hash comparisons + issuance history</li>
            </ul>
          </div>
        </div>

        <div class="callout">
          <strong>VeriPura fit:</strong> Notarization is the trust layer under document compliance (health certs, phyto certs,
          certificates of origin, lab tests, invoice/packing list reconciliation, revocations, amendments).
        </div>
      </section>

      <section class="card">
        <h2>Quick definitions</h2>
        <div class="mini">
          <p><strong>Hash</strong> = unique fingerprint of a file. If the file changes, the hash changes.</p>
          <p><strong>Immutable notarization</strong> = notarize once; any later change won’t match.</p>
          <p><strong>Versioned tracking</strong> = notarize every revision and link it to the prior version.</p>
        </div>
        <div class="mini" style="margin-top:12px;">
          <span class="badge">Practical rule</span>
          <p>
            If a document is supposed to be “final” (e.g., a completed lab test result), treat it as immutable.
            If it legitimately evolves (draft → reviewed → amended → final), track it with versioning.
          </p>
        </div>
      </section>
    </div>

    <section id="approaches" class="card" style="margin-top:14px;">
      <h2>Two document strategies</h2>

      <div class="twoCol">
        <div class="mini">
          <h3>Approach 1 — Immutable Document Notarization</h3>
          <p>
            Notarize the hash once. Verification is a direct check: <code>hash(current file) == hash(notarized)</code>.
          </p>
          <ul>
            <li>Best for: final signed certificates, lab results, issued certificates of origin</li>
            <li>Detects: post-issuance edits, forged copies, silent substitutions</li>
            <li>Simple: minimal metadata needed</li>
          </ul>
          <pre>Notarization event:
- doc_hash: abc123...
- timestamp: T0
- issuer_did: HealthAuthorityDID</pre>
        </div>

        <div class="mini">
          <h3>Approach 2 — Versioned Document Chain (Tracked Changes)</h3>
          <p>
            Notarize each revision and link it to the previous version. This yields an auditable history: what changed, when, and who did it.
          </p>
          <ul>
            <li>Best for: drafts, multi-stage approvals, amendments/corrections</li>
            <li>Detects: unauthorized changes, out-of-sequence approvals</li>
            <li>Supports: “current version pointer” + full version graph</li>
          </ul>
          <pre>Version chain:
v1: hash abc123... (Draft)          prev: null
v2: hash def456... (Revised)        prev: abc123...
v3: hash ghi789... (Final Approved) prev: def456...</pre>
        </div>
      </div>
    </section>

    <section id="usecases" class="card" style="margin-top:14px;">
      <h2>Illustrated VeriPura-style use cases</h2>

      <div class="mini">
        <h3>Use Case 1 — Certificate Amendment Tracking</h3>
        <p>
          Health certificate issued, then corrected (typo vs material change). Versioning makes the correction transparent and verifiable.
        </p>
        <div class="timeline">
          <div class="titem">
            <strong>v1 — Issued</strong>
            <div class="tmeta">
              Product: “Frozen shrimp” · Status: Issued · Hash: abc123… · Issuer: Authority DID
            </div>
          </div>
          <div class="titem">
            <strong>v2 — Amended</strong>
            <div class="tmeta">
              Product corrected to “Frozen prawns” · Change reason: clerical · Hash: def456… · Prev: abc123…
            </div>
          </div>
        </div>
        <p>
          VeriPura validation logic: verify amendment author (authority DID), require a reason code, alert importer if change is “material”.
        </p>
      </div>

      <div class="mini" style="margin-top:12px;">
        <h3>Use Case 2 — Multi-stage Approval Workflow</h3>
        <p>
          Document moves from exporter draft to final approval, with intermediate steps (e.g., lab test required).
          Each step becomes a version.
        </p>
        <div class="timeline">
          <div class="titem"><strong>v1</strong><div class="tmeta">Exporter submits draft · Hash: v1…</div></div>
          <div class="titem"><strong>v2</strong><div class="tmeta">Inspector requests pesticide test · Hash: v2… · Prev: v1…</div></div>
          <div class="titem"><strong>v3</strong><div class="tmeta">Lab results attached · Hash: v3… · Prev: v2…</div></div>
          <div class="titem"><strong>v4</strong><div class="tmeta">Health authority approves (final) · Hash: v4… · Prev: v3…</div></div>
          <div class="titem"><strong>v5</strong><div class="tmeta">Chamber co-signs · Hash: v5… · Prev: v4…</div></div>
        </div>
        <p>
          With Rebased smart contracts, you can enforce sequence rules (e.g., v4 cannot exist unless v3 exists).
        </p>
      </div>

      <div class="mini" style="margin-top:12px;">
        <h3>Use Case 3 — “Living Template” for Recurring Shipments</h3>
        <p>
          Keep a master template immutable (static exporter/importer/product specs), then notarize batch-specific instances that reference it.
        </p>
        <pre>Master Template (Immutable):
- exporter/importer identities
- product specs + protocols
- master_hash: master_abc123...

Batch Instance #2026-003:
- references master_abc123...
- batch fields (date, quantity, lot)
- hash: batch_def456...

Batch Instance #2026-004:
- references master_abc123...
- hash: batch_ghi789...</pre>
        <p>
          Benefit: consistency across shipments, faster doc generation, and clear auditability of what’s fixed vs what changes.
        </p>
      </div>
    </section>

    <section id="implementation" class="card" style="margin-top:14px;">
      <h2>Implementation options</h2>

      <div class="twoCol">
        <div class="mini">
          <h3>Option A — Off-chain version management</h3>
          <p>Each document version is notarized, but the “links” (prev version, change description) live in VeriPura’s database.</p>
          <ul>
            <li>Pros: fastest build, flexible metadata</li>
            <li>Cons: version chain integrity depends on VeriPura availability and correctness</li>
          </ul>
        </div>

        <div class="mini">
          <h3>Option B — On-chain version graph (Rebased smart contract)</h3>
          <p>Smart contract stores the version relationships and permissions. Anyone can reconstruct history from chain state.</p>
          <ul>
            <li>Pros: trust-minimized, cryptographically enforced sequence</li>
            <li>Cons: more contract logic + testing</li>
          </ul>
        </div>
      </div>

      <div class="mini" style="margin-top:12px;">
        <h3>Option C — Hybrid approach (recommended for VeriPura)</h3>
        <ul>
          <li><strong>Immutable</strong> for final documents: one notarization = “frozen”.</li>
          <li><strong>Versioned</strong> for drafts/workflows/amendments: notarize each change, link versions.</li>
          <li><strong>Template + instances</strong> for recurring shipments: one immutable master, multiple batch notarizations.</li>
        </ul>

        <pre>// Conceptual data tracked per version:
- content_hash (what)
- timestamp (when)
- author_did (who)
- change_description (why)
- previous_hash (link)</pre>
      </div>
    </section>

    <section id="quiz" class="card" style="margin-top:14px;">
      <div class="quizHead">
        <div>
          <h2>Multiple-choice quiz</h2>
          <p class="subtitle" style="margin-top:6px;">
            Answer all questions, then click “Grade quiz”. Your score and an explanation will appear.
          </p>
        </div>
        <div class="quizMeta">
          <button class="btn secondary" id="resetBtn" type="button">Reset</button>
          <button class="btn" id="gradeBtn" type="button">Grade quiz</button>
        </div>
      </div>

      <div id="quizContainer"></div>
      <div id="result" class="result" style="display:none;"></div>
    </section>

    <footer>
      Built as a single-file HTML explainer + quiz. Edit freely for your hackathon deck/demo.
    </footer>
  </div>

  <script>
    const quiz = [
      {
        id: "q1",
        question: "What does immutable notarization prove?",
        options: [
          "That a document can be edited freely without detection",
          "That a specific document version existed at a specific time and has not changed",
          "That the full document contents are publicly visible on-chain",
          "That only VeriPura can verify authenticity"
        ],
        correctIndex: 1,
        explain: "Immutable notarization anchors a hash + timestamp. If the file changes, the hash won’t match."
      },
      {
        id: "q2",
        question: "Which scenario is best suited to versioned (change-tracked) notarization?",
        options: [
          "Final lab test result that must never change after issuance",
          "A signed certificate of origin issued by a chamber of commerce",
          "A draft health certificate moving through review, amendments, and final approval",
          "A PDF you never intend to share with anyone"
        ],
        correctIndex: 2,
        explain: "Versioned tracking is for legitimate document evolution (draft → review → amended → final)."
      },
      {
        id: "q3",
        question: "In a version chain, what is the main purpose of storing the previous version hash?",
        options: [
          "To compress the document file size",
          "To link each version cryptographically to the version before it",
          "To make the document readable by customs scanners",
          "To encrypt the document contents"
        ],
        correctIndex: 1,
        explain: "The previous hash creates a verifiable chain so you can prove sequence and detect tampering."
      },
      {
        id: "q4",
        question: "What does the hybrid approach recommend for VeriPura?",
        options: [
          "Only immutable notarization for everything",
          "Only versioned tracking for everything",
          "Immutable notarization for final documents, versioned tracking for drafts/amendments, templates for recurring shipments",
          "No notarization until after the container arrives"
        ],
        correctIndex: 2,
        explain: "Different document types require different controls: final docs should be frozen; workflows need tracked changes."
      },
      {
        id: "q5",
        question: "If customs receives a certificate copy that does NOT match the notarized hash, the most accurate conclusion is:",
        options: [
          "The document must be valid; hashes are unreliable",
          "The document content differs from the notarized version (altered, substituted, or corrupted)",
          "The notarization automatically updates to match the new content",
          "Only the timestamp is wrong; the content is definitely correct"
        ],
        correctIndex: 1,
        explain: "A mismatch means the file content differs from what was notarized—exactly what hashes are designed to detect."
      },
      {
        id: "q6",
        question: "What additional fields make version tracking more useful for compliance (beyond hash + timestamp)?",
        options: [
          "Author DID and change description",
          "A rainbow color label for each version",
          "A password embedded in the PDF",
          "A screenshot of the document on a phone"
        ],
        correctIndex: 0,
        explain: "Who changed it (DID) and why (description/reason code) are crucial for auditability."
      }
    ];

    const quizContainer = document.getElementById("quizContainer");
    const resultBox = document.getElementById("result");
    const gradeBtn = document.getElementById("gradeBtn");
    const resetBtn = document.getElementById("resetBtn");

    function renderQuiz(){
      quizContainer.innerHTML = "";
      quiz.forEach((q, idx) => {
        const div = document.createElement("div");
        div.className = "q";
        div.innerHTML = `
          <p class="qtitle"><strong>Q${idx+1}.</strong> ${q.question}</p>
          <div class="opts">
            ${q.options.map((opt, i) => `
              <label class="opt">
                <input type="radio" name="${q.id}" value="${i}" />
                <span>${opt}</span>
              </label>
            `).join("")}
          </div>
        `;
        quizContainer.appendChild(div);
      });
      resultBox.style.display = "none";
      resultBox.innerHTML = "";
    }

    function gradeQuiz(){
      let correct = 0;
      const details = [];

      quiz.forEach((q, idx) => {
        const picked = document.querySelector(`input[name="${q.id}"]:checked`);
        const pickedIndex = picked ? parseInt(picked.value, 10) : null;
        const isCorrect = pickedIndex === q.correctIndex;
        if (isCorrect) correct++;

        details.push({
          n: idx+1,
          isCorrect,
          pickedIndex,
          correctIndex: q.correctIndex,
          explain: q.explain
        });
      });

      const total = quiz.length;
      const pct = Math.round((correct/total) * 100);

      let html = `<div class="score">Score: ${correct} / ${total} (${pct}%)</div>`;
      html += `<div style="margin-top:10px;">`;

      details.forEach(d => {
        const status = d.isCorrect ? `<span class="ok">Correct</span>` : `<span class="bad">Incorrect</span>`;
        const pickedText = (d.pickedIndex === null) ? "No answer" : quiz[d.n-1].options[d.pickedIndex];
        const correctText = quiz[d.n-1].options[d.correctIndex];
        html += `
          <div style="margin-top:10px; padding-top:10px; border-top:1px solid rgba(255,255,255,.10);">
            <div><strong>Q${d.n}:</strong> ${status}</div>
            <div style="margin-top:6px; color: var(--muted);">
              <div><strong>Your answer:</strong> ${pickedText}</div>
              <div><strong>Correct answer:</strong> ${correctText}</div>
              <div style="margin-top:6px;"><strong>Why:</strong> ${d.explain}</div>
            </div>
          </div>
        `;
      });

      html += `</div>`;

      resultBox.innerHTML = html;
      resultBox.style.display = "block";
      resultBox.scrollIntoView({behavior:"smooth", block:"start"});
    }

    function resetQuiz(){
      const radios = document.querySelectorAll('input[type="radio"]');
      radios.forEach(r => r.checked = false);
      resultBox.style.display = "none";
      resultBox.innerHTML = "";
      window.scrollTo({top: 0, behavior: "smooth"});
    }

    gradeBtn.addEventListener("click", gradeQuiz);
    resetBtn.addEventListener("click", () => { renderQuiz(); resetQuiz(); });

    renderQuiz();
  </script>
</body>
</html>
